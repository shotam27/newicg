# カード効果コスト修正レポート

## 問題の概要
カード効果の『コスト』の考え方に誤りがありました。本来のコストは**自フィールドの同種カード枚数**であるべきですが、IPを消費してしまっている箇所がありました。

## 修正した箇所

### 1. executeAbility メソッドの基本コスト処理
**修正前**: 獲得時効果以外でIP消費処理を行っていた
**修正後**: 自フィールドの同種カード枚数をチェックするように変更

```javascript
// 修正後のロジック
if (ability.type !== '獲得時' && ability.cost) {
  // 自フィールドの同種カード数をチェック
  const sameTypeCards = player.field.filter(fieldCard => fieldCard.id === card.id);
  if (sameTypeCards.length < ability.cost) {
    return this.createErrorResponse(
      ERROR_CODES.INSUFFICIENT_COST,
      `コストが不足しています（同種カード${ability.cost}枚必要、現在${sameTypeCards.length}枚）`
    );
  }
}
```

### 2. triggerOnAcquire メソッドの獲得時効果
**修正前**: IPコストをチェック・消費していた
**修正後**: 同種カード枚数のみをチェック（IPコスト処理を削除）

### 3. 侵略効果内でのIP消費処理
**修正状況**: 適切に処理済み
- IP消費は効果文に明記されている場合のみ実行（例: "IP10消費し"、"増加IP2消費し"）
- コスト自体は同種カード枚数でチェック

### 4. 反応効果
**修正状況**: 元々適切に実装済み
- IPを獲得する処理（IP+2など）
- IP消費は行わない

## 影響を受けるカード例

### ライオン (ID: 2)
1. **侵略 (cost: 1)**: "増加IP2消費し、1匹追放する"
   - コスト: ライオン1枚必要
   - 効果: 増加IP2消費して追放（効果文に明記されているため適切）

2. **侵略 (cost: 2)**: "IP10消費し、1匹追放する自身の疲労除去する"
   - コスト: ライオン2枚必要  
   - 効果: IP10消費して追放+疲労回復（効果文に明記されているため適切）

### サボテン (ID: 4)
1. **反応 (cost: 1)**: "IP+2"
   - コスト: サボテン1枚必要
   - 効果: IP+2獲得（消費ではなく獲得）

### ハチ (ID: 5)
1. **侵略 (cost: 1)**: "1匹疲労させる"
   - コスト: ハチ1枚必要
   - 効果: 疲労効果（IP消費なし）

## 修正の効果

1. **コストの正しい理解**: 全ての効果でコストは同種カード枚数として統一
2. **IP消費の明確化**: 効果文に明記されている場合のみIP消費
3. **ゲームバランス**: 本来の意図通りのコスト構造に修正

## 動作確認推奨項目

1. カード1-12の各効果が正しいコスト要件でチェックされることを確認
2. IP消費効果が効果文通りに動作することを確認
3. 反応効果でIPが正しく獲得されることを確認

---
修正日時: 2025-07-19
修正対象ファイル: server/game/CardEffects.js
